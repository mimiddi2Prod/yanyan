<script src="https://cdn.bootcss.com/jsencrypt/3.0.0-beta.1/jsencrypt.min.js"></script>
<script type="text/javascript">
    //封装的fetch - ajax
    function AJAX (url,method,body) {
        return new Promise((resolve, reject) => {
            fetch(url, {
                method: method,
                headers: {
                    'Content-Type':'application/x-www-form-urlencoded'
                },
                body: body
            }).then(response => {
                response.json().then(data => {
                    resolve(data)
                })
            }).catch(err => {
                reject(err)
            })
        })
    }

    function Encrypt(strSrc){
        const key = "-----BEGIN PUBLIC KEY-----\n" +
            "MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAIpZYxLs3J5FAIe2MFrK5+0PpeaYRGPo\n" +
            "Lm5UqjuSp6yCiJbQTt8tOU0ruhQnTGEmfcNChQrzexnTyWi7eMwfzG0CAwEAAQ==\n" +
            "-----END PUBLIC KEY-----"
        let encrypt = new JSEncrypt();
        encrypt.setPublicKey(key)
        const encryptKey = encrypt.encrypt(strSrc)
        console.info(encryptKey)
    }

    // ;(async ()=> {
    //     const key = await AJAX('http://127.0.0.1:3001/key','GET') //先从后端得到公钥
    //     let encrypt = new JSEncrypt();
    //     encrypt.setPublicKey(key.publicKey)
    //     const userInfo = 'username@password'  //需要加密的账号密码
    //     const encryptKey =  encrypt.encrypt(userInfo); //使用公钥加密，得到密文
    //     console.log(encryptKey)
    //     const key2 = await AJAX('http://127.0.0.1:3001/user','POST', `key=${encryptKey}`)//发送密文
    //     console.log(key2.publicKey)
    //     console.log(key2.publicKey == encryptKey) //测试发送的数据和后端接收的数据是否一致，很有必要！！！
    // })();
</script>
<html>
<button onclick="Encrypt('hello world_1')">ffff</button>
</html>